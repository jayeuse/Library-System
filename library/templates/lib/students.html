{% extends 'lib/base_main.html' %}

{% block title %}Students Page{% endblock %}

{% block header %}Welcome to the Students Page{% endblock %}

{% block content %}
    <h2>List of Students</h2>

    <form class="searchForm" id="searchForm">
        <input type="text" name="q" placeholder="Search by Student ID">
        <button type="submit">Search</button>
    </form>
    
    <table border=1>
        <thead>
            <tr>
                <th>Student ID</th>
                <th>Last Name</th>
                <th>First Name</th>
                <th>Course</th>
                <th>Year Level</th>
                <th>Section</th>
            </tr>
        </thead>
        <tbody>
            {% include 'partials/student_rows.html' %}
        </tbody>
    </table>

    <script>
        document.getElementById('searchForm').addEventListener('submit',
        async function(event) {
            event.preventDefault();
            let query = this.q.value;
            try {
                let response = await fetch("{% url 'student_list' %}?q=" + encodeURIComponent(query),{
                    method: "GET",
                    headers: { "X-Requested-With": "XMLHttpRequest" }
                });
                let data = await response.text();
                document.querySelector('tbody').innerHTML = data;
            } catch (error) {
                console.error('Error:', error);
            }
        })
    </script>
{% endblock %}

{% block footer %}Â© 2024 My Library{% endblock %}